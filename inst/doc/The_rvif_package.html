<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>The_rvif_package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">The_rvif_package</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The following is a presentation of the <em>rvif</em> package that
aims to facilitate its use. To this end, the document is divided into
four sections, each of them dedicated to each of the functions that make
up the package.</p>
<p>This package is focused on determining whether or not the degree of
approximate multicollinearity in a multiple linear regression model is
of concern, meaning that it affects the statistical analysis
(i.e. individual significance tests) of the model.</p>
<p>Please note that the results presented here are based on the articles
by Salmerón, García and García (2025) and Salmerón, García and García
(working paper), see bibliography at the end of the document.</p>
<p>We start by loading the <em>rvif</em> library, which in turn loads
the <em>multiColl</em> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(rvif)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Cargando paquete requerido: multiColl</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Cargando paquete requerido: car</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;car&#39; was built under R version 4.4.3</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Cargando paquete requerido: carData</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;carData&#39; was built under R version 4.4.3</span></span></code></pre></div>
</div>
<div id="cv_vif-function" class="section level2">
<h2><em>cv_vif</em> function</h2>
<p>Given the multiple linear regression model <span class="math inline">\(\mathbf{y} = \mathbf{X} \boldsymbol{\beta}
+  \mathbf{u},\)</span> where the design matrix <span class="math inline">\(\mathbf{X}\)</span> contains the observations of
each independent variable in columns, the function <em>cv_vif</em>
calculates the Coefficients of Variation (CV) and Variance Inflation
Factors (VIF) of each variable (column) contained in <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>The command and arguments of this function are as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># cv_vif(x, tol = 1e-30)</span></span></code></pre></div>
<p>Both CVs and VIFs are calculated using existing functions in the
<em>multiColl</em> package. Since these functions require the intercept
of the model to be in the first column of <span class="math inline">\(\mathbf{X}\)</span>, the design function matrix
<span class="math inline">\(\mathbf{X}\)</span> has to be entered as the
first argument of the <em>cv_vif</em> function so that the intercept is
in the first column.</p>
<p>This issue is crucial for ensuring the function works correctly.</p>
<div id="a-first-example-how-to-use-the-function" class="section level4">
<h4>A first example: how to use the function</h4>
<p>To illustrate this issue and how this function works, we will first
use the Wissel data available in the <em>rvif</em> package. For more
details use <em>help(Wissel)</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">head</span>(Wissel, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;      t      D cte      C      I     CP</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 1 1996 3.8051   1 4.7703 4.8786 808.23</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 2 1997 3.9458   1 4.7784 5.0510 798.03</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 3 1998 4.0579   1 4.9348 5.3620 806.12</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 4 1999 4.1913   1 5.0998 5.5585 865.65</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 5 2000 4.3585   1 5.2907 5.8425 997.30</span></span></code></pre></div>
<p>As can be seen, the design matrix <span class="math inline">\(\mathbf{X}\)</span> in this case is formed by the
last four columns. To calculate the CVs and VIFs of each independent
variable, the following code must be executed:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x <span class="ot">=</span> Wissel[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;                   CV      VIF</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Variable 2 0.1718940 589.7540</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Variable 3 0.2482804 281.8862</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; Variable 4 0.3607848 189.4874</span></span></code></pre></div>
<p>An alternative approach is to obtain the design matrix of the
independent variables after specifying the corresponding model using the
<em>lm</em> command and the <em>model.matrix</em> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">attach</span>(Wissel)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  reg_W <span class="ot">=</span> <span class="fu">lm</span>(D<span class="sc">~</span>C<span class="sc">+</span>I<span class="sc">+</span>CP)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">detach</span>(Wissel)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">model.matrix</span>(reg_W)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;                   CV      VIF</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; Variable 2 0.1718940 589.7540</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Variable 3 0.2482804 281.8862</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Variable 4 0.3607848 189.4874</span></span></code></pre></div>
<p>As can be seen, the same results are obtained in both cases.</p>
<p>According to Salmerón, Rodríguez and García (2020), the Coefficient
of Variation (CV) is useful for detecting non-essential
multicollinearity (the relationship between the intercept and at least
one of the remaining independent variables in a linear model). They
state specifically that if the CV of an independent variable is less
than 0.1002506, then it is related to the intercept and needs to be
centered to eliminate this relationship.</p>
<p>As can be seen from the Wissel data, the degree of non-essential
multicollinearity is not strong.</p>
<p>On the other hand, according to Salmerón, García and García (2018),
the VIF is only able to detect multicollinearity of the essential type
(linear relationship between at least two independent variables of the
linear model excluding the intercept). As VIF values suggest the
presence of this type of multicollinearity, the results clearly indicate
that it exists in the Wissel data model.</p>
</div>
<div id="a-second-example-construction-of-the-design-matrix" class="section level4">
<h4>A second example: construction of the design matrix</h4>
<p>Since the concept of multicollinearity only affects the independent
variables of the model, it is possible to detect multicollinearity
without considering the dependent variable.</p>
<p>When constructing the design matrix directly, it is important to note
that the first column must correspond to the intercept, as previously
mentioned.</p>
<p>The following simulation illustrates the situation:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    obs <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="fl">0.01</span>) <span class="co"># variable with very little variability</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    x3 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    x4 <span class="ot">=</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># fourth variable related to the third</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    x5 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2, x3, x4, x5) <span class="co"># the first column has to be the intercept</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;                      CV        VIF</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; Variable 2  0.002030169   1.025399</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; Variable 3  1.886093419 100.123352</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Variable 4  0.961634537 100.320601</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; Variable 5 10.725968638   1.025810</span></span></code></pre></div>
<p>In this case, it is observed that the second variable causes
non-essential multicollinearity, whereas the relation between the second
and third variables cause essential multicollinearity (this is how the
simulated data has been designed).</p>
</div>
<div id="a-third-example-checking-some-errors" class="section level4">
<h4>A third example: checking some errors</h4>
<p>In what follows, we will use the data on soil characteristics as
predictors of forest diversity from Bondell and Reich’s paper. This data
set is available in the <em>rvif</em> package. For more details, use
<em>help(soil)</em>.</p>
<p>This data set contains a variable called Sum Cations which is the sum
of the concentrations of calcium (Ca), magnesium (Mg), potassium (K) and
sodium (Na). For this reason, the VIF calculation produces errors in
this case.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">head</span>(soil, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;   BaseSat SumCation CECbuffer     Ca     Mg      K    Na     P    Cu    Zn</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1    2.34    0.1576     0.614 0.0892 0.0328 0.0256 0.010 0.000 0.080 0.184</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2    1.64    0.0970     0.516 0.0454 0.0218 0.0198 0.010 0.000 0.064 0.112</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3    5.20    0.4520     0.828 0.3306 0.0758 0.0336 0.012 0.240 0.136 0.350</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4    4.10    0.3054     0.698 0.2118 0.0536 0.0260 0.014 0.030 0.126 0.364</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5    2.70    0.2476     0.858 0.1568 0.0444 0.0304 0.016 0.384 0.078 0.376</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;      Mn HumicMatter Density    pH ExchAc Diversity</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 1 3.200      0.1220  0.0822 0.516  0.466 0.2765957</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 2 2.734      0.0952  0.0850 0.512  0.430 0.2613982</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 3 4.148      0.1822  0.0746 0.554  0.388 0.2553191</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 4 3.728      0.1646  0.0756 0.546  0.408 0.2401216</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 5 4.756      0.2472  0.0692 0.450  0.624 0.1884498</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    x <span class="ot">=</span> soil[,<span class="sc">-</span><span class="dv">16</span>]</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    </span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; System is computationally singular. Modify the design matrix before running the code.</span></span></code></pre></div>
<p>The second argument of this function sets the threshold used to
determine whether the system is computationally singular. Eliminating
the second variable allows the results to be obtained without any
problem.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x <span class="ot">=</span> soil[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">16</span>)]</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;                     CV          VIF</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; Variable 2  0.26254488 65655.631992</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Variable 3  0.93022708 49093.141906</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Variable 4  0.56511827  2096.203209</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Variable 5  0.24604041    78.315177</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Variable 6  0.23242890     7.017204</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Variable 7  1.41496855     5.451706</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Variable 8  0.37215759    10.065882</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Variable 9  0.42380972     8.879019</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Variable 10 0.25216470     3.132565</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Variable 11 0.28426257    31.738328</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Variable 12 0.07203395    23.370488</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; Variable 13 0.06026917    22.221129</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; Variable 14 0.14073646  7609.600200</span></span></code></pre></div>
<p>It is now observed that the design matrix has 14 variables, but the
output only provides information on 13 of these (from 2 to 14). This is
because the code is designed to eliminate the first column of the design
matrix (which corresponds to the intercept). In this case, the design
matrix entered does not have an intercept in its first column. This has
resulted in the elimination of the first variable.</p>
<p>This can be resolved either by entering the constant manually into
the design matrix, or by obtaining it from the specification of the
linear regression model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>y <span class="ot">=</span> soil[,<span class="dv">16</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>reg_S <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">as.matrix</span>(x))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">cv_vif</span>(<span class="fu">model.matrix</span>(reg_S))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;                     CV          VIF</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Variable 2  0.52570466   196.097486</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Variable 3  0.26254488 87577.945861</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Variable 4  0.93022708 63996.254093</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Variable 5  0.56511827  2478.282664</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; Variable 6  0.24604041    92.107236</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Variable 7  0.23242890     8.320798</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Variable 8  1.41496855     6.807994</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; Variable 9  0.37215759    11.966375</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Variable 10 0.42380972     9.795579</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; Variable 11 0.25216470     3.476432</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Variable 12 0.28426257    34.800524</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; Variable 13 0.07203395    26.743959</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; Variable 14 0.06026917    27.459519</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; Variable 15 0.14073646 10412.458323</span></span></code></pre></div>
<p>It can be seen that variables 13 (pH) and 14 (ExchAc) are causing
non-essential multicollinearity, while all the other variables, except
for 7 (Na), 8 (P), 10 (Zn) and 11 (Mn), are causing essential
multicollinearity.</p>
<p>If the design matrix is constructed directly but the intercept is not
positioned in the first column of the design matrix <span class="math inline">\(\mathbf{X}\)</span>, the following error message
occurs:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">cbind</span>(x, cte)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; There is a constant variable. Delete it before running the code or, if it is the intercept, it must be the first column of the design matrix.</span></span></code></pre></div>
</div>
<div id="a-fourth-example-the-special-case-of-the-simple-linear-regression-model" class="section level4">
<h4>A fourth example: the special case of the simple linear regression
model</h4>
<p>In the special case of the simple linear regression model, the design
matrix <span class="math inline">\(\mathbf{X}\)</span> consists of an
intercept and a second variable.</p>
<p>In this case, it makes no sense to calculate the VIF since it is
always equal to 1 regardless of the observed values of the second
variable (see Salmerón, Rodríguez and García (2020) for more
details).</p>
<p>For this reason, to execute the <em>cv_vif</em> function, the design
matrix (the first argument of the function) must have more than two
columns:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; At least 3 independent variables are needed (including the interceptin the first column) to carry out the calculations.</span></span></code></pre></div>
</div>
<div id="final-warning-regarding-the-presence-of-binary-variables-in-the-model" class="section level4">
<h4>Final warning regarding the presence of binary variables in the
model</h4>
<p>The code is not designed to distinguish between quantitative and
binary independent variables, so users should be especially careful when
interpreting results involving binary variables. Note that the VIF for a
binary variable is calculated using the coefficient of determination
from a regression in which the binary variable is treated as the
dependent variable. However, the coefficient of determination is
generally considered inappropriate in such cases, which is why models
such as logit or probit are typically recommended for binary
outcomes.</p>
<p>The following example illustrates this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>x3 <span class="ot">=</span> <span class="fu">rbinom</span>(obs, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2, x3)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">head</span>(x, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;      cte       x2 x3</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; [1,]   1 5.483027  1</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; [2,]   1 3.142566  0</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; [3,]   1 6.092618  1</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; [4,]   1 8.089956  0</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [5,]   1 4.483902  1</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="fu">cv_vif</span>(x)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;                   CV      VIF</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; Variable 2 1.3630182 1.066598</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Variable 3 0.9416966 1.066598</span></span></code></pre></div>
<p>All calculations involving a binary variable in the design matrix, X,
are performed without any problem. However, we would like to point out
to the reader that the associated VIF should not be interpreted as a
quantitative variable. We recommend ignoring it.</p>
</div>
</div>
<div id="cv_vif_plot-function" class="section level2">
<h2><em>cv_vif_plot</em> function</h2>
<p>The <em>cv_vif_plot</em> function is intended to facilitate the
interpretation of the results provided by the <em>cv_vif</em> function.
For this reason, the input of this function (first argument) is the
output from the <em>cv_vif</em> function. Consequently, it represents
the scatter plot of the Coefficient of Variation (CV) and the Variance
Inflation Factor (VIF) for the independent variables (excluding the
intercept) of a multiple linear regression model.</p>
<p>The command and arguments of this function are as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># cv_vif_plot(x, limit = 40)</span></span></code></pre></div>
<p>It should be noted that the distinction between essential and
non-essential multicollinearity and the limitations of each measure (CV
and VIF) for detecting the different kinds of multicollinearity, can be
very useful to detect if there is a troubling degree of
multicollinearity, what kind of multicollinearity it is and what
variables are causing it. For this purpose, it is important to include
in the representation of the scatter plot of the CV and VIF the lines
corresponding to the established thresholds for each measure: dashed
vertical line for 0.1002506 (CV) and dotted horizontal line for 10
(VIF).</p>
<p>These lines determine four regions (see the following graphical
representation) which can be interpreted as follows: A: existence of
troubling non-essential and non-troubling essential multicollinearity;
B: existence of troubling essential and non-essential multicollinearity;
C: existence of non-troubling non-essential and troubling essential
multicollinearity; D: non-troubling degree of existing multicollinearity
(essential and non-essential).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Coefficient of Variation&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Variance Inflation Factor&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">10</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.1002506</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.25</span>, <span class="dv">2</span>, <span class="st">&quot;A&quot;</span>, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.25</span>, <span class="dv">12</span>, <span class="st">&quot;B&quot;</span>, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="st">&quot;C&quot;</span>, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="st">&quot;D&quot;</span>, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="50%" style="display: block; margin: auto;" /></p>
<div id="some-examples" class="section level4">
<h4>Some examples</h4>
<p>When the <em>cv_vif_plot</em> command is applied to the Wissel data,
it is clear that the three independent variables have a CV greater than
0.1002506 (dashed vertical line) and a VIF greater than 10 (dotted
horizontal line). Therefore, it can be concluded immediately that the
degree of multicollinearity of the non-essential type is not strong, but
that of the essential type is.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>x <span class="ot">=</span> Wissel[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">cv_vif_plot</span>(<span class="fu">cv_vif</span>(x))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="50%" style="display: block; margin: auto;" /></p>
<p>When the <em>cv_vif_plot</em> function is applied to the simulation
of the second example of the <em>cv_vif</em> function, it can be
observed that the second variable causes non-essential multicollinearity
while the third and fourth variables cause essential
multicollinearity:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    obs <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="fl">0.01</span>) <span class="co"># variable with very little variability</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    x3 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    x4 <span class="ot">=</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># fourth variable related to the third</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>    x5 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2, x3, x4, x5) <span class="co"># the first column has to be the intercept</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    </span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="fu">cv_vif_plot</span>(<span class="fu">cv_vif</span>(x))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">cv_vif_plot</span>(<span class="fu">cv_vif</span>(x), <span class="at">limit=</span><span class="dv">0</span>) <span class="co"># note how the &#39;limit&#39; argument works</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="rvifs-function" class="section level2">
<h2><em>rvifs</em> function</h2>
<p>In their paper, Salmerón, García and García (2025) propose a
redefinition of the variance inflation factor (VIF) by modifying the
reference orthogonal model. The redefined VIF (RVIF) is defined as
follows: <span class="math display">\[RVIF(i) = \frac{\mathbf{X}_{i}^{t}
\mathbf{X}_{i}}{\mathbf{X}_{i}^{t} \mathbf{X}_{i} - \mathbf{X}_{i}^{t}
\mathbf{X}_{-i} \cdot \left( \mathbf{X}_{-i}^{t} \mathbf{X}_{-i} \right)
\cdot \mathbf{X}_{-i}^{t} \mathbf{X}_{i}},\]</span> which shows, among
other questions, that the RVIF is defined for <span class="math inline">\(i=1,2,\dots,k\)</span> (suppose the design matrix
<span class="math inline">\(\mathbf{X}\)</span> has <span class="math inline">\(k\)</span> independent variables (columns)). In
contrast to the VIF, the RVIF can therefore be calculated for the
intercept of the linear regression model.</p>
<p>The following other considerations should be taken into account:</p>
<ul>
<li><p>If the data are expressed in unit length, using the same
transformation used to calculate the condition number, then: <span class="math display">\[RVIF(i) = \frac{1}{1 - \mathbf{X}_{i}^{t}
\mathbf{X}_{-i} \cdot \left( \mathbf{X}_{-i}^{t} \mathbf{X}_{-i} \right)
\cdot \mathbf{X}_{-i}^{t} \mathbf{X}_{i}}, \quad
i=1,\dots,k.\]</span></p></li>
<li><p>In this case (data expressed in unit length), when <span class="math inline">\(\mathbf{X}_{i}\)</span> is orthogonal to <span class="math inline">\(\mathbf{X}_{-i}\)</span>, it is verified that
<span class="math inline">\(\mathbf{X}_{i}^{t} \mathbf{X}_{-i} =
\mathbf{0}\)</span> and, consequently <span class="math inline">\(RVIF(i) = 1\)</span> for <span class="math inline">\(i=1,\dots,k\)</span>. That is, the RVIF is always
greater than or equal to 1 and its minimum value is indicative of the
absence of multicollinearity.</p></li>
<li><p>Denoted by <span class="math inline">\(a_{i}= \mathbf{X}_{i}^{t}
\mathbf{X}_{i} \cdot \left( \mathbf{X}_{-i}^{t} \mathbf{X}_{-i} \right)
\cdot \mathbf{X}_{-i}^{t} \mathbf{X}_{i}\)</span>, <span class="math inline">\(RVIF(i) = \frac{1}{1-a_{i}}\)</span>, where <span class="math inline">\(a_{i}\)</span> can be interpreted as the
percentage of approximate multicollinearity due to the variable <span class="math inline">\(\mathbf{X}_{i}\)</span>. Note the similarity of
this expression to the VIF expression: <span class="math inline">\(VIF(i) = \frac{1}{1-R_{i}^{2}}\)</span>.</p></li>
<li><p>Finally, Salmerón, García and García (2025) show, from a
simulation for <span class="math inline">\(k=3\)</span>, that if <span class="math inline">\(a_{i} &gt; 0.826\)</span>, then the degree of
multicollinearity is worrying. In any case, this value should be refined
by considering a higher number of independent variables.</p></li>
</ul>
<p>In short, while it is not necessary to transform the data, it is
advisable to do so for a better interpretation of the results (as with
the condition number).</p>
<p>The <em>rvifs</em> function calculates the <span class="math inline">\(RVIF(i)\)</span> and <span class="math inline">\(a_{i}\)</span> values associated with the
independent variable <span class="math inline">\(i=1,2,\dots,k\)</span>.The command and arguments
of this function are as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># rvifs(x, ul = TRUE, intercept = TRUE, tol = 1e-30)</span></span></code></pre></div>
<p>As can be seen:</p>
<ul>
<li><p>The first argument to the function refers to the design matrix
<span class="math inline">\(\mathbf{X}\)</span>.</p></li>
<li><p>The novelty here is that the design matrix, <span class="math inline">\(\mathbf{X}\)</span>, may or may not have an
intercept. This is specified by the third argument. If an intercept is
present, as in previous cases, it must correspond to the first column of
<span class="math inline">\(\mathbf{X}\)</span>.</p></li>
<li><p>The second argument indicates whether the data has been
transformed to a unit length (the default value) or whether no
transformation has been performed.</p></li>
<li><p>The last argument is the threshold that determines whether the
system is computationally singular, similar to the <em>cv_vif</em>
function.</p></li>
</ul>
<div id="some-examples-1" class="section level4">
<h4>Some examples</h4>
<p>When the <em>rvifs</em> function is applied to the simulation of the
second example of the <em>cv_vif</em> function, it can be observed that
all the variables (except the last one) have high RVIF values and a high
percentage of approximate multicollinearity:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>    obs <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="fl">0.01</span>) <span class="co"># variable with very little variability</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    x3 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    x4 <span class="ot">=</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(obs, <span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># fourth variable related to the third</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    x5 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2, x3, x4, x5) <span class="co"># the first column has to be the intercept</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    </span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="fu">rvifs</span>(x)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt;                    RVIF       %</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; Intercept  2.495289e+05 99.9996</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; Variable 2 2.487886e+05 99.9996</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; Variable 3 1.282689e+02 99.2204</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; Variable 4 2.088057e+02 99.5211</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; Variable 5 1.034727e+00  3.3561</span></span></code></pre></div>
<p>However, when applied to data on soil characteristics, where there is
no intercept in the design matrix, high values are observed for all
variables:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>x <span class="ot">=</span> soil[,<span class="sc">-</span><span class="dv">16</span>]</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>    <span class="fu">rvifs</span>(x, <span class="at">intercept=</span><span class="cn">FALSE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; System is computationally singular. Modify the design matrix before running the code.</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="fu">rvifs</span>(x[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">intercept=</span><span class="cn">FALSE</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt;                     RVIF       %</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; Variable 1  9.055351e+02 99.8896</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; Variable 2  1.346429e+06 99.9999</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; Variable 3  1.363495e+05 99.9993</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; Variable 4  1.019537e+04 99.9902</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; Variable 5  1.613634e+03 99.9380</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; Variable 6  1.483139e+02 99.3258</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; Variable 7  1.019762e+01 90.1938</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; Variable 8  9.835658e+01 98.9833</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; Variable 9  6.422169e+01 98.4429</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; Variable 10 5.591258e+01 98.2115</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt; Variable 11 4.432249e+02 99.7744</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; Variable 12 4.653218e+03 99.9785</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; Variable 13 5.570325e+03 99.9820</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; Variable 14 5.334982e+05 99.9998</span></span></code></pre></div>
<p>Finally, by applying the <em>rvif</em> to the simple linear
regression model, we can determine the degree of non-essential
multicollinearity:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    </span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">rvifs</span>(x)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt;                RVIF       %</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Intercept  1.538266 34.9917</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Variable 2 1.538266 34.9917</span></span></code></pre></div>
<p>A high degree of non-essential multicollinearity is detected if a
variable with little variability is generated.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>cte <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, obs)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(obs, <span class="dv">3</span>, <span class="fl">0.04</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    </span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="fu">rvifs</span>(x)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;                RVIF       %</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Intercept  5459.413 99.9817</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; Variable 2 5459.413 99.9817</span></span></code></pre></div>
<p>If this variable is centered to solve the detected problem, the RVIFs
coincide with their minimum value, indicating orthogonality between the
elements of the design matrix:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>x2 <span class="ot">=</span> x2 <span class="sc">-</span> <span class="fu">mean</span>(x2)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>    </span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">cbind</span>(cte, x2)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">rvifs</span>(x)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt;            RVIF %</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; Intercept     1 0</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; Variable 2    1 0</span></span></code></pre></div>
<p>If the data are not transformed into unit length, the percentages of
multicollinearity due to each variable remain equal to zero. However,
since there is no universal minimum reference value, interpreting the
RVIF becomes more complicated:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">rvifs</span>(x, <span class="at">ul=</span><span class="cn">FALSE</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt;                RVIF %</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; Intercept  0.010000 0</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; Variable 2 6.065757 0</span></span></code></pre></div>
<p>This last example illustrates why it is advisable to transform the
data into unit length when calculating the RVIF.</p>
</div>
</div>
<div id="multicollinearity-function" class="section level2">
<h2><em>multicollinearity</em> function</h2>
<p>Until now, measures of the degree of multicollinearity in multiple
linear regression models have been used. However, it has never been
proven that this degree affects model analysis.</p>
<p>In their working paper, Salmerón, García and García propose a
statistical test that determines whether the degree of multicollinearity
affects the statistical analysis of the model, based on a region of
non-rejection (which depends on a level of significance).</p>
<p>More specifically, the test determines whether the non-rejection of
the null hypothesis in the individual significance tests of the
coefficient associated with each independent variable is due to the
degree of multicollinearity.</p>
<p>Ultimately, the decision rule for the test is determined by the
following result:</p>
<blockquote>
<p>Given the multiple linear regression model <span class="math inline">\(\mathbf{y} = \mathbf{X} \boldsymbol{\beta}
+  \mathbf{u}\)</span>, the degree of multicollinearity affects its
statistical analysis (with a level of significance of <span class="math inline">\(\alpha\%\)</span>) if there is a variable <span class="math inline">\(i\)</span>, with <span class="math inline">\(i=1,\dots,k\)</span>, that verifies <span class="math inline">\(RVIF(i) &gt; \max \{ c_{0}(i), c_{3}(i)
\}\)</span> where: <span class="math display">\[c_{0}(i) = \left(
\frac{\widehat{\beta}_{i}}{\widehat{\sigma} \cdot t_{n-k}(1-\alpha/2)}
\right)^{2}\]</span> and <span class="math display">\[c_{3}(i) = \left(
\frac{t_{n-k}(1-\alpha/2)}{\widehat{\beta}_{i,o}} \right)^{2} \cdot
\widehat{var} \left( \widehat{\beta}_{i} \right),\]</span> where <span class="math inline">\(\widehat{\beta}_{i}\)</span> is the OLS estimate
of <span class="math inline">\(\beta_{i}\)</span>, <span class="math inline">\(\widehat{var} \left( \widehat{\beta}_{i}
\right)\)</span> its estimated variance, <span class="math inline">\(\widehat{\beta}_{i,o}\)</span> is the OLS estimate
of <span class="math inline">\(\beta_{i}\)</span> in the orthogonal
model, <span class="math inline">\(\sigma^{2}\)</span> is the variance
of the random disturbance, and <span class="math inline">\(t_{n-k}(1-\alpha/2)\)</span> is the theoretical
value associated with the individual significance test.</p>
</blockquote>
<p>The <em>multicollinearity</em> function allows you to check the
condition of the theorem using the following code:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># multicollinearity(y, x, alpha = 0.05)</span></span></code></pre></div>
<p>The first argument of the function refers to the dependent variable
of the linear regression model. The second relates to the design matrix
containing the independent variables and the third to the significance
level considered in the statistical test.</p>
<p>Note that, as with the <em>cv_vif</em> function, the <em>rvif</em>
command will only work correctly if the design matrix has the intercept
in its first column.</p>
<p>It should also be noted that, in this case, the RVIF is calculated
without the data being transformed into unit length, as the results
obtained in the working paper by Salmerón, García and García do not
assume any transformation..</p>
<div id="a-first-example-wissel-data" class="section level3">
<h3>A first example: Wissel data</h3>
<p>In Wissel’s data on outstanding mortgage debt, the model is
considered jointly valid at the same time that is not rejected the null
hypothesis that each coefficient of the independent variables is
zero:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">summary</span>(reg_W)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = D ~ C + I + CP)</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; -1.2729 -0.7138  0.2853  0.7033  1.0711 </span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)  5.469264  13.016791   0.420    0.681</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; C           -4.252429   5.135058  -0.828    0.423</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; I            3.120395   2.035671   1.533    0.149</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; CP           0.002879   0.005764   0.499    0.626</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.9325 on 13 degrees of freedom</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.9235, Adjusted R-squared:  0.9058 </span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; F-statistic:  52.3 on 3 and 13 DF,  p-value: 1.629e-07</span></span></code></pre></div>
<p>Let us remember that a high degree of essential multicollinearity was
determined due to the three independent variables. However, when the
<em>multicollinearity</em> command is used, it can be observed that only
the second of these is affected by the detected problem:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>y <span class="ot">=</span> Wissel[,<span class="dv">2</span>]</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>x <span class="ot">=</span> Wissel[,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  </span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="fu">multicollinearity</span>(y, x)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt;          RVIFs           c0           c3 Scenario Affects</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt; 1 1.948661e+02 7.371069e+00 1.017198e+00      b.1     Yes</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt; 2 3.032628e+01 4.456018e+00 9.157898e-01      b.1     Yes</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; 3 4.765888e+00 2.399341e+00 1.053598e+01      b.2      No</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; 4 3.821626e-05 2.042640e-06 7.149977e-04      b.2      No</span></span></code></pre></div>
<p>In other words, it can be concluded that the failure to reject the
null hypothesis in the test associated with the personal consumption (C)
variable is due to the degree of multicollinearity in the model.</p>
</div>
<div id="a-second-example-klein-and-goldberger-data" class="section level3">
<h3>A second example: Klein and Goldberger data</h3>
<p>The <em>multiColl</em> package contains data from Klein and
Goldberger on consumption and wage income.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">data</span>(KG)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">attach</span>(KG)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  reg_KG <span class="ot">=</span> <span class="fu">lm</span>(consumption<span class="sc">~</span>wage.income<span class="sc">+</span>non.farm.income<span class="sc">+</span>farm.income)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">detach</span>(KG)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="fu">summary</span>(reg_KG)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; lm(formula = consumption ~ wage.income + non.farm.income + farm.income)</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; -13.494  -1.847   1.116   2.541   6.460 </span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)      18.7021     6.8454   2.732   0.0211 *</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co">#&gt; wage.income       0.3803     0.3121   1.218   0.2511  </span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">#&gt; non.farm.income   1.4186     0.7204   1.969   0.0772 .</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="co">#&gt; farm.income       0.5331     1.3998   0.381   0.7113  </span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 6.06 on 10 degrees of freedom</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.9187, Adjusted R-squared:  0.8943 </span></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="co">#&gt; F-statistic: 37.68 on 3 and 10 DF,  p-value: 9.271e-06</span></span></code></pre></div>
<p>Once again, at a 5% significance level, the null hypothesis is not
rejected in the individual significance tests, while the null hypothesis
is rejected in the joint significance test. This situation is considered
a sign of strong multicollinearity.</p>
<p>Using the <em>multicollinearity</em> command, it is possible to
determine that the statistical analysis of the second variable is
affected by the degree of multicollinearity in the model:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">head</span>(KG, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co">#&gt;   consumption wage.income non.farm.income farm.income</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">#&gt; 1        62.8       43.41           17.10        3.96</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt; 2        65.0       46.44           18.65        5.48</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co">#&gt; 3        63.9       44.35           17.09        4.37</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co">#&gt; 4        67.5       47.82           19.28        4.51</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt; 5        71.3       51.02           23.24        4.88</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  y <span class="ot">=</span> KG[,<span class="dv">1</span>]</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">model.matrix</span>(reg_KG)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  </span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="fu">multicollinearity</span>(y, x)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt;         RVIFs           c0           c3 Scenario Affects</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; 1 1.275947615 1.9183829079 0.0021892653      a.1      No</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co">#&gt; 2 0.002652862 0.0007931658 0.0001206694      b.1     Yes</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">#&gt; 3 0.014130621 0.0110372472 0.0187393601      b.2      No</span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co">#&gt; 4 0.053354814 0.0015584988 1.8265885762      b.2      No</span></span></code></pre></div>
</div>
<div id="a-third-example-the-case-of-the-simple-linear-regresion" class="section level3">
<h3>A third example: the case of the simple linear regresion</h3>
<p>The work of Salmerón, García and García (2025) illustrates the
limitations of the <em>vif</em> command in the <em>car</em> package for
detecting the degree of multicollinearity in a simple linear regression
model.</p>
<p>The data used in this work for this purpose are available in the
<em>rvif</em> package. For more details, use <em>help(SLM1)</em> and
<em>help(SLM2)</em>.</p>
<p>If the first one is used, the <em>vif</em> command effectively
indicates that the model has fewer than two terms and does not perform
any calculations:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">head</span>(SLM1, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt;           y1 cte         V</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt; 1  82.392059   1 19.001420</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; 2  -1.942157   1 -1.733458</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt; 3   7.474090   1  1.025146</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt; 4 -12.303381   1 -4.445014</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; 5  30.378203   1  6.689864</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="fu">attach</span>(SLM1)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt; The following object is masked _by_ .GlobalEnv:</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt;     cte</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  reg_SLM1 <span class="ot">=</span> <span class="fu">lm</span>(y1<span class="sc">~</span>V)</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="fu">detach</span>(SLM1)</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="fu">vif</span>(reg_SLM1)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a><span class="co">#&gt; Error in vif.default(reg_SLM1): model contains fewer than 2 terms</span></span></code></pre></div>
<p>In other words, it denies the possibility that the intercept could
form part of the model as another independent variable and,
consequently, there could be a problem of multicollinearity.</p>
<p>However, if the <em>multicollinearity</em> command is used, it is
possible to determine the degree of multicollinearity in the model and
whether it affects the statistical analysis of the model:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>y <span class="ot">=</span> SLM1[,<span class="dv">1</span>]</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>x <span class="ot">=</span> SLM1[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">multicollinearity</span>(y, x)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co">#&gt;          RVIFs        c0           c3 Scenario Affects</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co">#&gt; 1 0.0403049717 0.6454323 1.045802e-05      a.1      No</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#&gt; 2 0.0002675731 0.8383436 8.540101e-08      a.1      No</span></span></code></pre></div>
<p>While the degree of multicollinearity does not affect the statistical
analysis of the model in the first data set, it does affect the
second:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">head</span>(SLM2, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#&gt;         y2 cte         Z</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co">#&gt; 1 43.01204   1  9.978211</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co">#&gt; 2 40.04163   1  9.878235</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co">#&gt; 3 40.17086   1  9.924592</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co">#&gt; 4 40.79076   1 10.019123</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt; 5 44.72774   1 10.104728</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  y <span class="ot">=</span> SLM2[,<span class="dv">1</span>]</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  x <span class="ot">=</span> SLM2[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="fu">multicollinearity</span>(y, x)</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="co">#&gt;        RVIFs         c0         c3 Scenario Affects</span></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co">#&gt; 1 187.800878 21.4798003 0.03277691      b.1     Yes</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a><span class="co">#&gt; 2   1.879296  0.3687652 9.57724567      b.2      No</span></span></code></pre></div>
<p>It can be observed that when the significance level is changed, the
values of the non-rejection region (determined by the values <span class="math inline">\(c_{0}(i)\)</span> and $c_{3}(i)) change:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">multicollinearity</span>(y, x, <span class="at">alpha=</span><span class="fl">0.01</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co">#&gt;        RVIFs         c0         c3 Scenario Affects</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">#&gt; 1 187.800878 12.0701590  0.0583291      b.1     Yes</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#&gt; 2   1.879296  0.2072205 17.0434643      b.2      No</span></span></code></pre></div>
</div>
<div id="a-fourth-example-soil-characteristics-data" class="section level3">
<h3>A fourth example: soil characteristics data</h3>
<p>Using the <em>rvif</em> command on the soil characteristics data
revealed that all the variables had high RVIF values and a high
percentage of multicollinearity.</p>
<p>Meanwhile, using the <em>cv_vif</em> command revealed that the pH and
ExchAc variables caused a non-essential multicollinearity problem, while
all other variables except Na, P, Zn nad Mn caused essential
multicollinearity.</p>
<p>Using the *multicollinearity** command, it is observed that only the
statistical analysis of the intercept, CECbuffer and HumicMatter is
affected by the degree of multicollinearity present:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>y <span class="ot">=</span> soil[,<span class="dv">16</span>]</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>x <span class="ot">=</span> soil[,<span class="sc">-</span><span class="dv">16</span>] </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>intercept <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y))</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">cbind</span>(intercept, x) <span class="co"># the design matrix has to have the intercept in the first column</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="fu">multicollinearity</span>(y, x)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co">#&gt; System is computationally singular. Modify the design matrix before running the code.</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  </span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  <span class="fu">multicollinearity</span>(y, x[,<span class="sc">-</span><span class="dv">3</span>]) <span class="co"># eliminating the problematic variable (SumCation)</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="co">#&gt;           RVIFs           c0           c3 Scenario Affects</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="co">#&gt; 1  4.407184e+02 6.150190e-03 1.480048e+00      b.1     Yes</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co">#&gt; 2  3.828858e+00 1.142356e-02 7.653413e+00      b.2      No</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co">#&gt; 3  1.093791e+05 1.254955e+02 7.236491e+04      b.1     Yes</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="co">#&gt; 4  9.883235e+04 3.938383e+01 2.237445e+05      b.2      No</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="co">#&gt; 5  1.767758e+05 1.101028e+03 3.609837e+05      b.2      No</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="co">#&gt; 6  1.150029e+05 1.627349e+03 1.976176e+05      b.2      No</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="co">#&gt; 7  4.627807e+04 5.960870e+02 2.033176e+06      b.2      No</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="co">#&gt; 8  1.338591e+01 6.062571e-01 4.060382e+02      b.2      No</span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a><span class="co">#&gt; 9  3.113066e+02 4.089095e+01 5.246698e+05      b.2      No</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a><span class="co">#&gt; 10 5.177176e+01 6.371216e+00 8.094828e+02      b.2      No</span></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a><span class="co">#&gt; 11 1.905089e-01 3.907589e-02 9.787963e-01      b.2      No</span></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a><span class="co">#&gt; 12 3.379360e+02 4.534540e+01 2.861964e+02      b.1     Yes</span></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="co">#&gt; 13 4.761238e+04 8.453066e+01 3.828016e+08      b.2      No</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a><span class="co">#&gt; 14 1.502903e+03 7.901580e+01 9.961215e+03      b.2      No</span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co">#&gt; 15 1.066711e+05 2.369347e+02 4.802466e+07      b.2      No</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>  </span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a><span class="fu">names</span>(x[,<span class="sc">-</span><span class="dv">3</span>])  </span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;intercept&quot;   &quot;BaseSat&quot;     &quot;CECbuffer&quot;   &quot;Ca&quot;          &quot;Mg&quot;         </span></span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;K&quot;           &quot;Na&quot;          &quot;P&quot;           &quot;Cu&quot;          &quot;Zn&quot;         </span></span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a><span class="co">#&gt; [11] &quot;Mn&quot;          &quot;HumicMatter&quot; &quot;Density&quot;     &quot;pH&quot;          &quot;ExchAc&quot;</span></span></code></pre></div>
</div>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
<ul>
<li><p>Bondell, H.D. and Reich. B.J. (2008). Simultaneous regression
shrinkage, variable selection, and supervised clustering of predictors
with OSCAR. Biometrics, 64 (1), 115–23, doi: <a href="https://doi.org/10.1111/j.1541-0420.2007.00843.x" class="uri">https://doi.org/10.1111/j.1541-0420.2007.00843.x</a>.</p></li>
<li><p>Salmerón, R., García, C.B. and García, J. (2018). Variance
Inflation Factor and Condition Number in multiple linear regression.
Journal of Statistical Computation and Simulation, 88(12), 2365-2384,
doi: <a href="https://doi.org/10.1080/00949655.2018.1463376" class="uri">https://doi.org/10.1080/00949655.2018.1463376</a>.</p></li>
<li><p>Salmerón, R., Rodríguez, A. and García, C.B. (2020). Diagnosis
and quantification of the non-essential collinearity. Computational
Statistics, 35(2), 647-666, doi: <a href="https://doi.org/10.1007/s00180-019-00922-x" class="uri">https://doi.org/10.1007/s00180-019-00922-x</a>.</p></li>
<li><p>Salmerón, R., García, C.B. and García, J. (2025). A redefined
Variance Inflation Factor: overcoming the limitations of the Variance
Inflation Factor. Computational Economics, 65, 337-363, doi: <a href="https://doi.org/10.1007/s10614-024-10575-8" class="uri">https://doi.org/10.1007/s10614-024-10575-8</a>.</p></li>
<li><p>Overcoming the inconsistences of the variance inflation factor: a
redefined VIF and a test to detect statistical troubling
multicollinearity by Salmerón, R., García, C.B and García, J. (working
paper submitted to The R Journal, <a href="https://arxiv.org/pdf/2005.02245" class="uri">https://arxiv.org/pdf/2005.02245</a>).</p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
